<div class="sidebar">
  {{$currentNode := .}}
  <nav class="slide-menu" aria-labelledby="table-of-contents">
    <h2 id="table-of-contents" class="sr-only">Table Of Contents</h2>
    <ul class="treeview-navigation" role="tree" aria-label="Contents">
      <li role="none">
        <a role="treeitem" {{ if .IsHome }}aria-current="page"{{ end }} href="{{ .Site.BaseURL }}">
          <span class="label">Home</span>
        </a>
      </li>
      {{- range .Site.Home.Sections.ByWeight -}}
        {{template "slide-menu" dict "sect" . "currentnode" $currentNode}}
      {{- end -}}
    </ul>
  </nav>
</div>

{{define "slide-menu"}}
  {{- $currentNode := .currentnode -}}
  {{ with .sect }}
    {{- safeHTML .Params.head -}}
    {{- $hasPages := or .Pages .Sections -}}
    <li role="none">
      {{- if $hasPages -}}
        <a role="treeitem"
          aria-expanded="{{- if .IsAncestor $currentNode -}}true{{- else -}}false{{- end -}}"
          aria-owns="id-about-subtree"
          href="{{ .Permalink }}"
          {{- if and .File $currentNode.File -}}
            {{- if eq .File.UniqueID $currentNode.File.UniqueID }}aria-current="page"{{ end -}}
          {{- end -}}
        >
          <span class="label">
            <span class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="13" height="10" viewBox="0 0 13 10">
                <polygon points="2 1, 12 1, 7 9"></polygon>
              </svg>
            </span>
            {{ .Title }}
          </span>
        </a>
        <ul id="id-about-subtree" role="group" aria-label="About">
          {{- .Scratch.Set "pages" .Pages -}}
          {{- if .Sections -}}
            {{- .Scratch.Set "pages" (.Pages | union .Sections) -}}
          {{- end -}}
          {{- $pages := (.Scratch.Get "pages") -}}
          {{- range $pages.ByWeight -}}
            {{template "slide-menu" dict "sect" . "currentnode" $currentNode}}
          {{- end -}}
        </ul>
      {{- else -}}
        <a role="treeitem"
          href="{{ .Permalink }}"
          {{- if and .File $currentNode.File -}}
            {{- if eq .File.UniqueID $currentNode.File.UniqueID }}aria-current="page"{{ end -}}
          {{- end -}}
        >
          <span class="label">{{ .Title }}</span>
        </a>
      {{- end -}}
    </li>
  {{ end -}}
{{ end }}
